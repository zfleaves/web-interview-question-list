# 22. Vue3 的自定义指令如何实现无限滚动？

**答案：**

```javascript
app.directive('infinite-scroll', {
  mounted(el, binding) {
    const callback = binding.value;

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          callback();
        }
      });
    }, {
      rootMargin: '100px'
    });

    observer.observe(el);

    el._observer = observer;
  },
  unmounted(el) {
    if (el._observer) {
      el._observer.disconnect();
    }
  }
});

// 使用
<div v-infinite-scroll="loadMore">Content</div>
```

---