# 7. Vue3 的生命周期有哪些变化？

**答案：**

**生命周期钩子对比：**

```javascript
// Vue2
export default {
  beforeCreate() {
    console.log('beforeCreate');
  },
  created() {
    console.log('created');
  },
  beforeMount() {
    console.log('beforeMount');
  },
  mounted() {
    console.log('mounted');
  },
  beforeUpdate() {
    console.log('beforeUpdate');
  },
  updated() {
    console.log('updated');
  },
  beforeDestroy() {
    console.log('beforeDestroy');
  },
  destroyed() {
    console.log('destroyed');
  }
};

// Vue3
import {
  onBeforeMount,
  onMounted,
  onBeforeUpdate,
  onUpdated,
  onBeforeUnmount,
  onUnmounted,
  onErrorCaptured,
  onRenderTracked,
  onRenderTriggered
} from 'vue';

export default {
  setup() {
    // beforeCreate 和 created 被 setup() 替代
    onBeforeMount(() => {
      console.log('beforeMount');
    });
    
    onMounted(() => {
      console.log('mounted');
    });
    
    onBeforeUpdate(() => {
      console.log('beforeUpdate');
    });
    
    onUpdated(() => {
      console.log('updated');
    });
    
    onBeforeUnmount(() => {
      console.log('beforeUnmount');
    });
    
    onUnmounted(() => {
      console.log('unmounted');
    });
    
    onErrorCaptured((err, instance, info) => {
      console.error('error:', err);
    });
    
    onRenderTracked((e) => {
      console.log('render tracked:', e);
    });
    
    onRenderTriggered((e) => {
      console.log('render triggered:', e);
    });
  }
};

// 映射关系
// Vue2                Vue3
// beforeCreate   ->   setup()
// created        ->   setup()
// beforeMount    ->   onBeforeMount
// mounted        ->   onMounted
// beforeUpdate   ->   onBeforeUpdate
// updated        ->   onUpdated
// beforeDestroy  ->   onBeforeUnmount
// destroyed      ->   onUnmounted
// errorCaptured  ->   onErrorCaptured
// -              ->   onRenderTracked (dev only)
// -              ->   onRenderTriggered (dev only)
```

**新的调试钩子：**

```javascript
import { onRenderTracked, onRenderTriggered } from 'vue';

export default {
  setup() {
    // 追踪依赖
    onRenderTracked((e) => {
      console.log('tracked:', e.target, e.type, e.key);
    });
    
    // 追踪触发
    onRenderTriggered((e) => {
      console.log('triggered:', e.target, e.type, e.key, e.oldValue, e.newValue);
    });
  }
};

// 使用场景：
// 1. 调试性能问题
// 2. 分析依赖关系
// 3. 优化渲染性能
```
