# 5. 如何实现一个前端路由系统？

**答案：**

```javascript
// Hash 路由实现
class HashRouter {
  constructor() {
    this.routes = {};
    this.currentUrl = '';
    this.init();
  }
  
  init() {
    // 监听 hash 变化
    window.addEventListener('hashchange', this.handleHashChange.bind(this));
    window.addEventListener('load', this.handleHashChange.bind(this));
  }
  
  // 注册路由
  register(path, handler) {
    this.routes[path] = handler;
  }
  
  // 处理 hash 变化
  handleHashChange() {
    const hash = window.location.hash.slice(1) || '/';
    this.currentUrl = hash;
    this.matchRoute(hash);
  }
  
  // 路由匹配
  matchRoute(path) {
    // 精确匹配
    if (this.routes[path]) {
      this.routes[path]();
      return;
    }
    
    // 动态路由匹配
    for (const route in this.routes) {
      const params = this.matchDynamicRoute(route, path);
      if (params) {
        this.routes[route](params);
        return;
      }
    }
    
    // 404 处理
    if (this.routes['*']) {
      this.routes['*']();
    }
  }
  
  // 动态路由匹配
  matchDynamicRoute(route, path) {
    const routeParts = route.split('/');
    const pathParts = path.split('/');
    
    if (routeParts.length !== pathParts.length) {
      return null;
    }
    
    const params = {};
    
    for (let i = 0; i < routeParts.length; i++) {
      const routePart = routeParts[i];
      const pathPart = pathParts[i];
      
      if (routePart.startsWith(':')) {
        params[routePart.slice(1)] = pathPart;
      } else if (routePart !== pathPart) {
        return null;
      }
    }
    
    return params;
  }
  
  // 导航
  navigate(path) {
    window.location.hash = path;
  }
  
  // 替换
  replace(path) {
    window.location.replace(`#${path}`);
  }
  
  // 后退
  back() {
    window.history.back();
  }
  
  // 前进
  forward() {
    window.history.forward();
  }
}
```

---
