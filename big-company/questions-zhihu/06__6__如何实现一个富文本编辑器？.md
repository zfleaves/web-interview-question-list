# 6. 如何实现一个富文本编辑器？

**答案：**

```javascript
class RichTextEditor extends React.Component {
  constructor(props) {
    super(props);
    this.editorRef = React.createRef();
    this.state = {
      content: ''
    };
  }
  
  componentDidMount() {
    if (this.editorRef.current) {
      this.editorRef.current.contentEditable = true;
      this.editorRef.current.addEventListener('input', this.handleInput);
    }
  }
  
  componentWillUnmount() {
    if (this.editorRef.current) {
      this.editorRef.current.removeEventListener('input', this.handleInput);
    }
  }
  
  handleInput = (e) => {
    this.setState({ content: e.target.innerHTML });
    if (this.props.onChange) {
      this.props.onChange(e.target.innerHTML);
    }
  };
  
  // 执行命令
  execCommand(command, value = null) {
    document.execCommand(command, false, value);
    this.editorRef.current.focus();
  };
  
  // 加粗
  bold = () => this.execCommand('bold');
  
  // 斜体
  italic = () => this.execCommand('italic');
  
  // 下划线
  underline = () => this.execCommand('underline');
  
  // 标题
  setHeading = (level) => this.execCommand('formatBlock', `h${level}`);
  
  // 列表
  insertList = (type) => this.execCommand(type === 'ul' ? 'insertUnorderedList' : 'insertOrderedList');
  
  // 插入链接
  insertLink = () => {
    const url = prompt('请输入链接地址：');
    if (url) {
      this.execCommand('createLink', url);
    }
  };
  
  // 插入图片
  insertImage = () => {
    const url = prompt('请输入图片地址：');
    if (url) {
      this.execCommand('insertImage', url);
    }
  };
  
  render() {
    return (
      <div className="rich-text-editor">
        <div className="toolbar">
          <button onClick={this.bold}>加粗</button>
          <button onClick={this.italic}>斜体</button>
          <button onClick={this.underline}>下划线</button>
          <select onChange={(e) => this.setHeading(e.target.value)}>
            <option value="p">段落</option>
            <option value="h1">标题1</option>
            <option value="h2">标题2</option>
            <option value="h3">标题3</option>
          </select>
          <button onClick={() => this.insertList('ul')}>无序列表</button>
          <button onClick={() => this.insertList('ol')}>有序列表</button>
          <button onClick={this.insertLink}>插入链接</button>
          <button onClick={this.insertImage}>插入图片</button>
        </div>
        <div
          ref={this.editorRef}
          className="editor-content"
          contentEditable={true}
          dangerouslySetInnerHTML={{ __html: this.state.content }}
        />
      </div>
    );
  }
}
```

---
