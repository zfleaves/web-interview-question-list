# 14. 实现防抖函数

**答案：**

```javascript
function debounce(func, wait = 300) {
  let timeout = null;
  
  return function(...args) {
    clearTimeout(timeout);
    timeout = setTimeout(() => {
      func.apply(this, args);
    }, wait);
  };
}

// 使用
const searchInput = debounce((keyword) => {
  console.log('搜索:', keyword);
  fetch(`/api/search?keyword=${keyword}`)
    .then(res => res.json())
    .then(data => console.log(data));
}, 500);

// 搜索框输入
const input = document.querySelector('input');
input.addEventListener('input', (e) => {
  searchInput(e.target.value);
});
```

**带立即执行选项的防抖：**

```javascript
function debounceWithImmediate(func, wait = 300, immediate = false) {
  let timeout = null;
  
  return function(...args) {
    const callNow = immediate && !timeout;
    
    clearTimeout(timeout);
    timeout = setTimeout(() => {
      timeout = null;
      if (!immediate) {
        func.apply(this, args);
      }
    }, wait);
    
    if (callNow) {
      func.apply(this, args);
    }
  };
}

// 使用
const resizeHandler = debounceWithImmediate(
  () => console.log('窗口大小改变'),
  300,
  true
);

window.addEventListener('resize', resizeHandler);
```

**富途特色考点：**
- 富途高频考察函数节流和防抖
- 结合实际场景说明性能优化的应用
- 考察对异步控制的理解

---
