# 5. 如何实现一个虚拟滚动列表？

**答案：**

```javascript
class VirtualList extends React.Component {
  state = {
    visibleStart: 0,
    visibleEnd: 10
  };
  
  containerRef = React.createRef();
  
  componentDidMount() {
    this.containerRef.current.addEventListener('scroll', this.handleScroll);
  }
  
  componentWillUnmount() {
    this.containerRef.current.removeEventListener('scroll', this.handleScroll);
  }
  
  handleScroll = () => {
    const container = this.containerRef.current;
    const scrollTop = container.scrollTop;
    const itemHeight = 50;
    const visibleCount = Math.ceil(container.clientHeight / itemHeight);
    
    const start = Math.floor(scrollTop / itemHeight);
    const end = start + visibleCount;
    
    this.setState({
      visibleStart: start,
      visibleEnd: end
    });
  };
  
  render() {
    const { items, itemHeight = 50 } = this.props;
    const { visibleStart, visibleEnd } = this.state;
    
    const visibleItems = items.slice(visibleStart, visibleEnd);
    const totalHeight = items.length * itemHeight;
    const offsetY = visibleStart * itemHeight;
    
    return (
      <div
        ref={this.containerRef}
        style={{
          height: '500px',
          overflow: 'auto'
        }}
      >
        <div style={{ height: totalHeight, position: 'relative' }}>
          <div
            style={{
              transform: `translateY(${offsetY}px)`,
              position: 'absolute',
              top: 0,
              left: 0,
              right: 0
            }}
          >
            {visibleItems.map((item, index) => (
              <div
                key={index}
                style={{
                  height: itemHeight,
                  boxSizing: 'border-box',
                  padding: '10px',
                  borderBottom: '1px solid #eee'
                }}
              >
                {item}
              </div>
            ))}
          </div>
        </div>
      </div>
    );
  }
}
```

---
