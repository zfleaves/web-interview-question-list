# 4. 请简述前端性能优化全链路方案

**答案：**

**性能优化核心思路：**

1. **加载性能优化**（减少首屏时间）
2. **运行性能优化**（减少卡顿、提高响应速度）
3. **渲染性能优化**（提高 FPS、减少重排重绘）

**具体优化手段：**

```javascript
// 1. 资源加载优化

// 代码分割（Webpack）
module.exports = {
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          chunks: 'all',
        },
      },
    },
  },
};

// 动态导入
const Home = lazy(() => import('./Home'));
const About = lazy(() => import('./About'));

// 预加载关键资源
<link rel="preload" href="critical.css" as="style">
<link rel="prefetch" href="next-page.js">

// 2. 运行性能优化

// 防抖和节流
function debounce(fn, delay) {
  let timer = null;
  return function(...args) {
    clearTimeout(timer);
    timer = setTimeout(() => fn.apply(this, args), delay);
  };
}

function throttle(fn, interval) {
  let lastTime = 0;
  return function(...args) {
    const now = Date.now();
    if (now - lastTime >= interval) {
      fn.apply(this, args);
      lastTime = now;
    }
  };
}

// 3. 渲染性能优化

// 使用 CSS3 动画替代 JS 动画
.element {
  transition: transform 0.3s;
  will-change: transform;
}

// 批量 DOM 操作
const fragment = document.createDocumentFragment();
items.forEach(item => {
  const node = document.createElement('div');
  node.textContent = item.text;
  fragment.appendChild(node);
});
document.body.appendChild(fragment);

// 4. 网络优化

// HTTP 缓存
// 强制缓存
Cache-Control: max-age=31536000

// 协商缓存
ETag: "abc123"
Last-Modified: Wed, 21 Oct 2015 07:28:00 GMT"

// 5. 图片优化

// 图片懒加载
<img src="placeholder.jpg" data-src="real-image.jpg" loading="lazy">

// 响应式图片
<picture>
  <source srcset="image-small.jpg" media="(max-width: 600px)">
  <source srcset="image-medium.jpg" media="(max-width: 1200px)">
  <img src="image-large.jpg">
</picture>
```

**阿里特色考点：**
- 阿里高频考察性能优化的全链路思维
- 结合阿里业务场景（如电商大促）说明优化方案
- 考察对性能监控工具的使用经验

---
