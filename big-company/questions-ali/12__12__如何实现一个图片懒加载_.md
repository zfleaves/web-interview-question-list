# 12. 如何实现一个图片懒加载？

**答案：**

```javascript
class LazyImage {
  constructor(options = {}) {
    this.options = {
      rootMargin: '100px',
      threshold: 0.1,
      ...options
    };
    
    this.observer = new IntersectionObserver(
      this.handleIntersect.bind(this),
      this.options
    );
  }
  
  observe(element) {
    this.observer.observe(element);
  }
  
  handleIntersect(entries) {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const img = entry.target;
        const src = img.dataset.src;
        
        if (src) {
          img.src = src;
          img.onload = () => {
            img.classList.add('loaded');
          };
          img.onerror = () => {
            img.classList.add('error');
          };
        }
        
        this.observer.unobserve(img);
      }
    });
  }
}

// 使用
const lazyImage = new LazyImage({
  rootMargin: '100px',
  threshold: 0.1
});

document.querySelectorAll('img[data-src]').forEach(img => {
  lazyImage.observe(img);
});
```

**阿里特色考点：**
- 阿里高频考察图片懒加载的实现原理
- 结合电商图片展示说明优化效果
- 考察对 IntersectionObserver API 的熟练使用

---
