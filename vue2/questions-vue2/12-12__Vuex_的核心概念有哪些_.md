# 12. Vuex 的核心概念有哪些？

**答案：**

**1. State（状态）：**

```javascript
const store = new Vuex.Store({
  state: {
    count: 0,
    user: null,
    todos: []
  }
});

// 组件中访问
this.$store.state.count;

// 使用 mapState
import { mapState } from 'vuex';

export default {
  computed: {
    ...mapState(['count', 'user']),
    ...mapState({
      myCount: state => state.count,
      userAge: state => state.user.age
    })
  }
};
```

**2. Getters（计算属性）：**

```javascript
const store = new Vuex.Store({
  state: {
    todos: [
      { id: 1, text: '...', done: true },
      { id: 2, text: '...', done: false }
    ]
  },
  getters: {
    doneTodos: state => {
      return state.todos.filter(todo => todo.done);
    },
    doneTodosCount: (state, getters) => {
      return getters.doneTodos.length;
    },
    getTodoById: (state) => (id) => {
      return state.todos.find(todo => todo.id === id);
    }
  }
});

// 组件中访问
this.$store.getters.doneTodos;

// 使用 mapGetters
import { mapGetters } from 'vuex';

export default {
  computed: {
    ...mapGetters(['doneTodos', 'doneTodosCount']),
    ...mapGetters({
      doneCount: 'doneTodosCount'
    })
  }
};
```

**3. Mutations（同步修改）：**

```javascript
const store = new Vuex.Store({
  state: {
    count: 0
  },
  mutations: {
    increment(state) {
      state.count++;
    },
    incrementBy(state, payload) {
      state.count += payload.amount;
    }
  }
});

// 组件中提交
this.$store.commit('increment');
this.$store.commit('incrementBy', { amount: 10 });

// 使用 mapMutations
import { mapMutations } from 'vuex';

export default {
  methods: {
    ...mapMutations(['increment', 'incrementBy']),
    ...mapMutations({
      add: 'increment'
    })
  }
};
```

**4. Actions（异步操作）：**

```javascript
const store = new Vuex.Store({
  state: {
    count: 0,
    user: null
  },
  mutations: {
    increment(state) {
      state.count++;
    },
    setUser(state, user) {
      state.user = user;
    }
  },
  actions: {
    incrementAsync({ commit }) {
      setTimeout(() => {
        commit('increment');
      }, 1000);
    },
    actionA({ commit, state }) {
      return new Promise((resolve, reject) => {
        setTimeout(() => {
          commit('increment');
          resolve();
        }, 1000);
      });
    },
    async actionB({ dispatch, commit }) {
      await dispatch('actionA');
      commit('increment');
    },
    async fetchUser({ commit }, userId) {
      try {
        const response = await api.getUser(userId);
        commit('setUser', response.data);
      } catch (error) {
        console.error(error);
      }
    }
  }
});

// 组件中分发
this.$store.dispatch('incrementAsync');
this.$store.dispatch('fetchUser', 123);

// 使用 mapActions
import { mapActions } from 'vuex';

export default {
  methods: {
    ...mapActions(['incrementAsync', 'fetchUser']),
    ...mapActions({
      addAsync: 'incrementAsync'
    })
  }
};
```

**5. Modules（模块化）：**

```javascript
const moduleA = {
  namespaced: true,
  state: { count: 0 },
  mutations: { increment(state) { state.count++ } },
  actions: { incrementIfOddOnRootSum({ state, commit, rootState }) { } },
  getters: { doubleCount(state) { return state.count * 2 } }
};

const moduleB = {
  namespaced: true,
  state: { ... },
  mutations: { ... },
  actions: { ... }
};

const store = new Vuex.Store({
  modules: {
    a: moduleA,
    b: moduleB
  }
});

// 组件中访问
this.$store.state.a.count;
this.$store.getters['a/doubleCount'];
this.$store.commit('a/increment');
this.$store.dispatch('a/incrementIfOddOnRootSum');

// 使用 mapState、mapGetters 等辅助函数
import { mapState, mapGetters } from 'vuex';

export default {
  computed: {
    ...mapState('a', ['count']),
    ...mapGetters('a', ['doubleCount'])
  }
};
```

**6. 严格模式：**

```javascript
const store = new Vuex.Store({
  strict: process.env.NODE_ENV !== 'production'
});

// 严格模式下，state 修改只能在 mutation 中进行
// 否则会抛出错误
```
