## 10. 责任链模式是什么？

**答案：**

责任链模式使多个对象都有机会处理请求，从而避免请求的发送者和接收者之间的耦合关系。将这些对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它为止。

### JavaScript 实现

```javascript
class Handler {
  constructor() {
    this.nextHandler = null;
  }

  setNext(handler) {
    this.nextHandler = handler;
    return handler;
  }

  handle(request) {
    if (this.nextHandler) {
      return this.nextHandler.handle(request);
    }
    return null;
  }
}

class ConcreteHandler1 extends Handler {
  handle(request) {
    if (request === 'request1') {
      return `Handled by Handler1: ${request}`;
    }
    return super.handle(request);
  }
}

class ConcreteHandler2 extends Handler {
  handle(request) {
    if (request === 'request2') {
      return `Handled by Handler2: ${request}`;
    }
    return super.handle(request);
  }
}

class ConcreteHandler3 extends Handler {
  handle(request) {
    if (request === 'request3') {
      return `Handled by Handler3: ${request}`;
    }
    return super.handle(request);
  }
}

// 使用
const handler1 = new ConcreteHandler1();
const handler2 = new ConcreteHandler2();
const handler3 = new ConcreteHandler3();

handler1.setNext(handler2).setNext(handler3);

console.log(handler1.handle('request1')); // Handled by Handler1: request1
console.log(handler1.handle('request2')); // Handled by Handler2: request2
console.log(handler1.handle('request3')); // Handled by Handler3: request3
```

### 实际应用：审批流程

```javascript
class Approver {
  constructor(name) {
    this.name = name;
    this.nextApprover = null;
  }

  setNext(approver) {
    this.nextApprover = approver;
    return approver;
  }

  approve(amount) {
    if (this.nextApprover) {
      return this.nextApprover.approve(amount);
    }
    console.log(`${this.name}: Cannot approve ${amount}`);
    return false;
  }
}

class Manager extends Approver {
  approve(amount) {
    if (amount <= 1000) {
      console.log(`${this.name}: Approved ${amount}`);
      return true;
    }
    return super.approve(amount);
  }
}

class Director extends Approver {
  approve(amount) {
    if (amount <= 5000) {
      console.log(`${this.name}: Approved ${amount}`);
      return true;
    }
    return super.approve(amount);
  }
}

class CEO extends Approver {
  approve(amount) {
    console.log(`${this.name}: Approved ${amount}`);
    return true;
  }
}

// 使用
const manager = new Manager('Manager');
const director = new Director('Director');
const ceo = new CEO('CEO');

manager.setNext(director).setNext(ceo);

manager.approve(500);   // Manager: Approved 500
manager.approve(2000);  // Director: Approved 2000
manager.approve(10000); // CEO: Approved 10000
```

### 应用场景

1. **审批流程**
2. **异常处理**
3. **日志记录**
4. **事件处理**

---