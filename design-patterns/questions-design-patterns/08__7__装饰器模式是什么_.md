## 7. 装饰器模式是什么？

**答案：**

装饰器模式动态地给一个对象添加一些额外的职责，就增加功能来说，装饰器模式相比生成子类更为灵活。

### JavaScript 实现

```javascript
class Coffee {
  cost() {
    return 10;
  }

  description() {
    return 'Coffee';
  }
}

// 装饰器基类
class CoffeeDecorator {
  constructor(coffee) {
    this.coffee = coffee;
  }

  cost() {
    return this.coffee.cost();
  }

  description() {
    return this.coffee.description();
  }
}

// 具体装饰器
class MilkDecorator extends CoffeeDecorator {
  cost() {
    return this.coffee.cost() + 2;
  }

  description() {
    return `${this.coffee.description()}, Milk`;
  }
}

class SugarDecorator extends CoffeeDecorator {
  cost() {
    return this.coffee.cost() + 1;
  }

  description() {
    return `${this.coffee.description()}, Sugar`;
  }
}

// 使用
let coffee = new Coffee();
console.log(coffee.description(), coffee.cost()); // Coffee 10

coffee = new MilkDecorator(coffee);
console.log(coffee.description(), coffee.cost()); // Coffee, Milk 12

coffee = new SugarDecorator(coffee);
console.log(coffee.description(), coffee.cost()); // Coffee, Milk, Sugar 13
```

### React 高阶组件（HOC）

```javascript
// 装饰器模式在 React 中的应用
function withLoading(WrappedComponent) {
  return function WithLoadingComponent(props) {
    if (props.isLoading) {
      return <div>Loading...</div>;
    }
    return <WrappedComponent {...props} />;
  };
}

// 使用
const UserProfile = ({ user }) => {
  return <div>{user.name}</div>;
};

const UserProfileWithLoading = withLoading(UserProfile);

// 使用
<UserProfileWithLoading isLoading={true} user={null} />
<UserProfileWithLoading isLoading={false} user={{ name: 'John' }} />
```

### 应用场景

1. **React 高阶组件**
2. **日志记录**
3. **性能监控**
4. **权限控制**

---