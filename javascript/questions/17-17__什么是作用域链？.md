# 17. 什么是作用域链？

**答案：**

**作用域链定义：**

作用域链是 JavaScript 中变量查找的机制，当代码访问一个变量时，会先在当前作用域查找，找不到就向上级作用域查找，直到全局作用域。

```javascript
// 作用域链示例
var globalVar = 'global';

function outer() {
  var outerVar = 'outer';
  
  function inner() {
    var innerVar = 'inner';
    
    console.log(innerVar); // 'inner' (当前作用域)
    console.log(outerVar); // 'outer' (outer 作用域)
    console.log(globalVar); // 'global' (全局作用域)
    console.log(nonExistent); // ReferenceError (找不到)
  }
  
  inner();
}

outer();
```

**作用域链查找过程：**

```
inner 函数作用域
  └── innerVar: 'inner'
  └── outer 函数作用域
      └── outerVar: 'outer'
      └── 全局作用域
          └── globalVar: 'global'
```

**块级作用域：**

```javascript
// ES6 之前：var 没有块级作用域
if (true) {
  var x = 10;
}
console.log(x); // 10 (可以访问)

// ES6：let 和 const 有块级作用域
if (true) {
  let y = 10;
}
console.log(y); // ReferenceError (无法访问)
```

**场景题：**

```javascript
// 场景 1：变量提升
console.log(a); // undefined (var 提升)
var a = 10;

console.log(b); // ReferenceError (let 不提升)
let b = 20;

// 场景 2：闭包与作用域
function createCounter() {
  let count = 0;
  
  return {
    increment: function() {
      count++;
      console.log(count);
    },
    getCount: function() {
      return count;
    }
  };
}

const counter = createCounter();
counter.increment(); // 1
counter.increment(); // 2
console.log(counter.getCount()); // 2

// 场景 3：IIFE 避免污染全局作用域
(function() {
  var privateVar = 'private';
  console.log(privateVar);
})();

console.log(privateVar); // ReferenceError (无法访问)

// 场景 4：模块模式
const module = (function() {
  let privateVar = 0;
  
  return {
    getPrivateVar: function() {
      return privateVar;
    },
    setPrivateVar: function(value) {
      privateVar = value;
    }
  };
})();

console.log(module.getPrivateVar()); // 0
module.setPrivateVar(10);
console.log(module.getPrivateVar()); // 10
```

---