## 8. 小程序的性能优化有哪些？

**答案：**

### 1. 减少包体积

```javascript
// 按需引入
import { debounce } from 'lodash-es';

// 使用分包
{
  "pages": [
    "pages/index/index",
    "pages/detail/detail"
  ],
  "subPackages": [
    {
      "root": "packageA",
      "pages": [
        "pages/pageA/pageA",
        "pages/pageB/pageB"
      ]
    }
  ]
}
```

### 2. 图片优化

```javascript
// 使用 webp 格式
<image src="image.webp" mode="aspectFill" />

// 懒加载
<image lazy-load src="image.jpg" />

// 压缩图片
wx.compressImage({
  src: tempFilePaths[0],
  quality: 80,
  success(res) {
    console.log(res.tempFilePath);
  }
});
```

### 3. 数据优化

```javascript
// 分页加载
Page({
  data: {
    list: [],
    page: 1,
    hasMore: true
  },
  
  onLoad() {
    this.loadData();
  },
  
  onReachBottom() {
    if (this.data.hasMore) {
      this.loadData();
    }
  },
  
  async loadData() {
    const { page, list } = this.data;
    const newData = await this.fetchData(page);
    
    this.setData({
      list: [...list, ...newData],
      page: page + 1,
      hasMore: newData.length >= 10
    });
  }
});
```

### 4. 渲染优化

```javascript
// 使用 virtual-list 处理长列表
// 避免频繁 setData
// 使用 wx:if 而不是 hidden 来控制显示隐藏
```

---