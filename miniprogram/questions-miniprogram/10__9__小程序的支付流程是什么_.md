## 9. 小程序的支付流程是什么？

**答案：**

### 支付流程

```javascript
// 1. 统一下单
wx.request({
  url: 'https://api.example.com/pay/unifiedorder',
  method: 'POST',
  data: {
    orderId: '123456',
    amount: 100
  },
  success(res) {
    const { timeStamp, nonceStr, package, signType, paySign } = res.data;
    
    // 2. 发起支付
    wx.requestPayment({
      timeStamp,
      nonceStr,
      package,
      signType,
      paySign,
      success(res) {
        console.log('支付成功');
        // 3. 查询支付结果
        this.checkPaymentStatus();
      },
      fail(err) {
        console.error('支付失败', err);
      }
    });
  }
});

// 查询支付结果
function checkPaymentStatus() {
  wx.request({
    url: 'https://api.example.com/pay/query',
    method: 'POST',
    data: {
      orderId: '123456'
    },
    success(res) {
      if (res.data.status === 'SUCCESS') {
        console.log('支付成功');
      }
    }
  });
}
```

---